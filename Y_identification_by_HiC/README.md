# Identify Y-linked sequences with Hi-C interaction 

Some Y-linked scaffolds may have normal coverage of female reads mapped due to the repeat sequences that are shared between X chromosome and Y chromosome. Here we utilized the Hi-C interaction strength to identify them from the unplaced scaffolds.

## Input

- Hi-C matrix (generated by HiCPro)
  - input_10000_abs.bed in `hic_results/matrix/input/raw/10000/`
  - input_10000_iced.matrix in `hicpro_out/hic_results/matrix/input/iced/10000/`

- autosome_X.bed: confirmed autosomal/X sequences, BED format

- Y.bed: confirmed Y-linked scaffolds/chromosome, BED format
- scaf.bed: unplaced scaffolds, BED format

## How to run

```bash
awk '{print $4"\t"$0}' input_10000_abs.bed | cut -f1-4 > input_10000_abs.bed.cut

perl AddColumn.v2.pl input_10000_iced.matrix input_10000_abs.bed.cut 1 | perl AddColumn.v2.pl - input_10000_abs.bed.cut 2 | awk '{print $4"\t"$5"\t"$6"\t"$7"\t"$8"\t"$9"\t"$3}' > input_10000_iced.matrix.add

python3 get_overlap.py scaf.bed input_10000_iced.matrix.add > input_10000_iced.matrix.add.filt

python3 calculate.v1.1.py scaf.bed input_10000_iced.matrix.add.filt Y.bed autosome_X.bed > scaf.bed.tab

perl pick.column_info.pl scaf.bed.tab scaf.bed 1 1 -t diff | awk '{print $1"\tNA\tNA\tNA\tNA\tNA\tNA\tNA\tNA\tNA\tNA\tNA"}' >> scaf.bed.tab

perl AddColumn.v2.pl scaf.bed.tab genome.fa.fai 1 | cut -f1-13 | sort -k13,13nr > scaf.bed.tab.add

perl fdr.excludeNA.pl scaf.bed.tab.add > scaf.bed.tab.add.fdr_excludeNA
```

## Output format

the final output file is scaf.bed.tab.add.fdr_excludeNA

```
scafID	confirmed_Y_ID	#interaction	lower_quantile	median	upper_quantile	confirmed_A/X_ID	#interaction	lower_quantile	median	upper_quantile	p.value	scaf_length	FDR-corrected.p.value
JAALXP010000164.1_decollapsed	CM021938.1_decollapsed	212	0.2767	0.5211	2.0370	Super_scaffold_pat_5	2397	0.1287	0.1896	0.5003	0.0000	1080123	0
JAALXP010000169.1_decollapsed	CM021938.1_decollapsed	17	3.5522	4.8172	7.2965	Super_scaffold_pat_15	1179	1.8016	2.8119	5.5004	0.0010	1024496	0.00157142857142857
JAALXP010000180.1_decollapsed	CM021938.1_decollapsed	872	3.9170	5.6886	8.8754	Super_scaffold_pat_18	375	1.3894	2.2788	3.2111	0.0000	805729	0
```

Column 2-6 contain interaction information between unplaced scaffold and confirmed Y

Column 7-11 contains interaction information between unplaced scaffold and confirmed autosome/X

Result can be filtered with the strength comparison (column 5 vs column 10) and FDR-corrected p.value